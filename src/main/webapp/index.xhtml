<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:c="jakarta.tags.core">


    <h:head>
        <meta charset="utf-8" />
        <title>Księgarnia</title>
        <h:outputStylesheet>
            /* Globalny styl */
            body {
            background-color: #f4f4f9;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            }

            /* Styl dla siatki książek */
            .book-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3 kolumny */
            gap: 20px;
            margin: 0 auto;
            max-width: 1200px;
            padding: 0 10px;
            }

            /* Karta książki */
            .book-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.15);
            padding: 15px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0px 6px 18px rgba(0, 0, 0, 0.2);
            }

            .book-image {
            width: 100%;
            height: 300px;
            object-fit: contain; /* Obrazek w pełni widoczny, bez przycinania */
            border-radius: 8px;
            margin-bottom: 10px;
            }

            .book-title {
            font-size: 1.2em;
            font-weight: bold;
            margin: 10px 0;
            color: #333;
            }

            .book-price {
            font-size: 1.1em;
            color: #ff5733;
            margin-bottom: 10px;
            }

            .book-details {
            font-size: 0.9em;
            color: #777;
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            }

            .details-link {
            display: inline-block;
            padding: 8px 15px;
            background-color: #ff5733;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
            }

            .details-link:hover {
            background-color: #cc4628;
            }

            /* Responsywność */
            @media (max-width: 1024px) {
            .book-grid {
            grid-template-columns: repeat(2, 1fr); /* 2 kolumny dla tabletów */
            }

            @media (max-width: 768px) {
            .book-grid {
            grid-template-columns: 1fr; /* 1 kolumna dla telefonów */
            }





            }
        </h:outputStylesheet>
        <style>
            .container {
                display: flex;

            }
            .left, .right {
                width: 20%; /* Lewa i prawa kolumna po 20% */

            }
            .center {
                width: 60%; /* Środkowa kolumna 60% */
                padding: 20px;
            }
            /* Kontener przycisków paginacji */
            .pagination-container {
                text-align: center; /* Wyśrodkowanie przycisków */
                margin-top: 20px; /* Odstęp od treści książek */
            }

            /* Styl przycisków paginacji */
            .pagination-btn {
                padding: 10px 20px; /* Wygodne paddingi */
                font-size: 14px; /* Wielkość czcionki */
                background-color: #007bff; /* Kolor tła przycisków */
                color: white; /* Kolor tekstu */
                border: none;
                border-radius: 5px; /* Zaokrąglone rogi */
                margin: 0 10px; /* Odstępy między przyciskami */
                cursor: pointer; /* Wskaźnik w postaci ręki */
            }

            .pagination-btn:hover {
                background-color: #0056b3; /* Kolor przycisku po najechaniu */
            }

        </style>
    </h:head>

    <h:body>
        <!-- menubar -->
        <div class="card" >
            <h:form>
                <p:growl id="messages"/>
                <p:menubar hideDelay="1000">
                    <f:facet name="start">
                        <p:graphicImage name="logo.jpg" library="images"  />
                    </f:facet>
                    <p:divider layout="vertical"/>
                    <p:menuitem value="koszyk"  action="#{ksiazkiListBB.showBusket}" icon="pi pi-shopping-bag" disabled="#{not logInOutBB.loggedIn}">
                    </p:menuitem>
                    <p:divider layout="vertical"/>
                    <p:menuitem value="biblioteczka" icon="pi pi-book"  action="#{zamowieniaPage.OrdersPage}" disabled="#{not logInOutBB.loggedIn}" />
                    <p:divider layout="vertical"/>
                    <p:menuitem value="#{userData.loggedInUser.imie} #{userData.loggedInUser.nazwisko}" icon="pi pi-fw pi-user" action="#{userData.userPage}" disabled="#{not logInOutBB.loggedIn}" />

                    <p:submenu label="Role" icon="pi pi-shopping-bag" disabled="#{not logInOutBB.loggedIn}">
                        <c:forEach items="#{userData.userRoles}" var="role">
                            <p:menuitem value="#{role.rolaidRola.nazwaRoli}" icon="pi pi-fw pi-user" />
                        </c:forEach>
                    </p:submenu>
                    <p:divider layout="vertical"/>
                    <!-- Panel wyszukiwania -->
                    <f:facet name="end">
                        <div class="ui-input-icon-left mr-2">
                            <i class="pi pi-fw pi-search" />
                            <p:inputText placeholder="Search" value="#{ksiazkiListBB.tytul}">
                                <p:ajax event="keyup" listener="#{ksiazkiListBB.getList}" update="booksTable" />
                            </p:inputText>
                        </div>

                        <!-- Przycisk Logout - widoczny tylko jeśli użytkownik jest zalogowany -->
                        <p:commandButton value="Logout" action="#{logInOutBB.logout}" icon="pi pi-fw pi-sign-out" styleClass="ui-button-info" rendered="#{logInOutBB.loggedIn}" />

                        <!-- Przycisk Login - widoczny tylko jeśli użytkownik nie jest zalogowany -->
                        <p:commandButton value="Login" action="#{logInOutBB.loginPage}" icon="pi pi-fw pi-sign-in" styleClass="ui-button-info" rendered="#{not logInOutBB.loggedIn}" />
                    </f:facet>
                </p:menubar>
            </h:form>
        </div>

        <div class="container">
            <!-- Lewa pusta kolumna -->
            <div class="left"></div>

            <!-- Środkowa kolumna z koszykiem i książkami -->
            <div class="center">

                <!-- Książki -->
                <h:form id="booksTable">
                    <p:growl id="msgs" showDetail="true"/>
                    <div class="book-grid">
                        <ui:repeat value="#{ksiazkiListBB.list}" var="k">
                            <div class="book-card">
                                <h:graphicImage value="/resources/#{k.imgUrl}" styleClass="book-image" />
                                <div class="book-title">
                                    <h:outputText value="#{k.tytul}" />
                                </div>
                                <div class="book-price">
                                    <h:outputText value="#{k.cena} PLN" />
                                </div>
                                <div class="book-details">
                                    <ui:repeat var="a" value="#{ksiazkiHasAutorKsiazkiBB.list}">
                                        <h:panelGroup rendered="#{k.idKsiazki eq a.ksiazkiidKsiazki.idKsiazki}">
                                            <span><b>Autor:</b> #{a.autorKsiazkiidAutorKsiazki.imie} #{a.autorKsiazkiidAutorKsiazki.nazwisko}</span>
                                        </h:panelGroup>
                                    </ui:repeat>
                                    <span><b>Ilość sztuk:</b> #{k.iloscsztuk}</span>
                                </div>
                                <p:commandButton value="Zobacz" styleClass="details-link" action="#{ksiazkiListBB.showBook(k)}" ajax="false" />

                                <p:commandButton value="Dodaj do koszyka" 
                                                 styleClass="details-link"  
                                                 action="#{ksiazkiListBB.addToBusket(k)}"  
                                                 update=":koszykForm" />
                            </div>
                        </ui:repeat>
                    </div>
                    <div class="pagination-container">
                        <p:commandButton value="Poprzednia" action="#{ksiazkiListBB.prevPage}" ajax="true" update="booksTable" styleClass="pagination-btn"/>
                        <p:commandButton value="Następna" action="#{ksiazkiListBB.nextPage}" ajax="true" update="booksTable" styleClass="pagination-btn" />
                    </div>

                </h:form>
            </div>

            <!-- Prawa pusta kolumna -->
            <div class="right">

                <h3>Twój koszyk</h3>

                <div class="product card">
                    <h:form id="koszykForm">
                        <p:dataScroller value="#{ksiazkiListBB.getBusket()}" var="ksiazka" chunkSize="3" mode="inline"
                                        scrollHeight="200">
                            <f:facet name="header">
                                Scroll Down to Load More Products
                            </f:facet>
                            <div class="product" >
                                <div class="product-list-item p-5" style="display: flex; align-items: center; justify-content: space-between; border: 1px solid #ccc; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                                    <p:graphicImage value="/resources/#{ksiazka.imgUrl}" style="height: 30px; margin-right: 15px;" />
                                    <div class="product-list-detail" style="flex-grow: 1;">
                                        <div class="product-name">#{ksiazka.tytul}</div>
                                    </div>
                                    <div class="product-list-action" style="text-align: right; margin-left: 15px;">
                                        <h:outputText value="#{ksiazka.cena}" styleClass="product-price">
                                            <f:convertNumber currencySymbol="$" type="currency" />
                                        </h:outputText>
                                        <p:commandButton value="Usuń" action="#{ksiazkiListBB.usunBusket(ksiazka)}" update="koszykForm" icon="pi pi-shopping-cart" />
                                    </div>
                                </div>
                            </div>
                        </p:dataScroller>
                        <p:commandButton value="Wyczyść koszyk" action="#{ksiazkiListBB.wyczyscBusket()}" update="koszykForm" />
                    </h:form>
                </div>

            </div>
        </div>

    </h:body>
</html>
